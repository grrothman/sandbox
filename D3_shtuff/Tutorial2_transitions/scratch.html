<!doctype html>

<html>
	<head>
        <meta charset="utf-8">
        <title>D3 Transitions Test</title>
        <script type="text/javascript" src="d3/d3.js"></script>
        <style type="text/css">
        </style>
	</head>

	<body>
		<div id="wrapper">
			<div id="circles">
				<svg width="100%" height="100%">
					<rect x="0" y="0" width="100%" height="100%" fill="#ff0000" stroke="none">
					</rect>
					<circle cx="55%" cy="30%" r="1%">
					</circle>
					<circle cx="54%" cy="30%" r="1%">
					</circle>
					<circle cx="53%" cy="30%" r="1%">
					</circle>
					<circle cx="52%" cy="30%" r="1%">
					</circle>
					<circle cx="51%" cy="30%" r="1%">
					</circle>
					<circle cx="50%" cy="30%" r="1%">
					</circle>
					<circle cx="49%" cy="30%" r="1%">
					</circle>
					<circle cx="48%" cy="30%" r="1%">
					</circle>
					<circle cx="47%" cy="30%" r="1%">
					</circle>
					<circle cx="46%" cy="30%" r="1%">
					</circle>
					<circle cx="45%" cy="30%" r="1%">
					</circle>
					<circle cx="44%" cy="30%" r="1%">
					</circle>
					<circle cx="43%" cy="30%" r="1%">
					</circle>
					<circle cx="42%" cy="30%" r="1%">
					</circle>
					<circle cx="41%" cy="30%" r="1%">
					</circle>
					<circle cx="40%" cy="30%" r="1%">
					</circle>
				</svg>
			</div>
		</div>
		<script type="text/javascript">
		//PICK UP AT "Pretty cool, but itâ€™s time for a reset."
			// var intro = d3.select("#intro")
			// intro.style("background color", "red")
			//  	 .style("font family", "Helvetica")
			//  	 .style("color", "blue")
			
			// d3.selectAll("circle")
			// .transition()
			// .delay(function(d,i){
			// 	return i*100;
			// })
			// .duration(4000)
			// .attr("cy", "65%")
			// .attr("fill", "lime")
			// .attr("r", function(d,i){
			// 	return ((Math.sin(i/5)+1.1)*3) + "%";
			// })
			
			var recolor = function() {
				d3.selectAll("rect")
				  .transition()
				  .duration(3000)
				  .attr("fill", "hsl(" + (Math.random()*360) + ",100%,50%)")
				  .each("end", recolor);
			  };			

			recolor()

			crazy_wave = function() {
				//move to bottom and change color
				d3.select(this)
				.transition()
				//.delay(function(d, i) {return i * 50;})
				.duration(3000)
				.attr("cy", "0%")
				.attr("fill", "hsl(" + (Math.random()*360) + ",100%,50%)")
				.each("end", function() {
					
					//move to top and change color AGAIN!
					d3.select(this)
						.transition()
						.delay(function(d,i) {
							return i * 50;
						})
						.duration(3000)
						.attr("cy", "100%")
						.attr("fill", "hsl(" + (Math.random()*360) + ",100%,50%)")
						.each("end", crazy_wave);
				});
			};

			d3.selectAll("circle")
				.transition()
				.delay(function(d,i) {
					return i*50;
				})
				.duration(3000)
				.attr("cy", "100%")
				.each("end", crazy_wave)

			//reset
			// d3.selectAll("circle")
			//   .transition()
			//   .duration(500)
			//   .attr("r", "1%")

		</script>
	</body>

</html>